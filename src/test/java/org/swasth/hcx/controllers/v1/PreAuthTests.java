package org.swasth.hcx.controllers.v1;

import org.junit.jupiter.api.Test;
import org.springframework.beans.factory.annotation.Value;
import org.springframework.http.MediaType;
import org.springframework.mock.web.MockHttpServletResponse;
import org.springframework.test.web.servlet.MvcResult;
import org.swasth.hcx.controllers.BaseSpec;

import static org.junit.jupiter.api.Assertions.assertEquals;
import static org.mockito.ArgumentMatchers.any;
import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.post;


public class PreAuthTests extends BaseSpec {

    @Value("${hcx_application.api_version}")
    private String api_version;

    @Test
    public void check_preauth_submit_success_scenario() throws Exception {
        postgresService.execute("DROP TABLE IF EXISTS mock_participant");
        postgresService.execute("CREATE TABLE mock_participant (\n" +
                "    parent_participant_code character varying,\n" +
                "    child_participant_code character varying PRIMARY KEY,\n" +
                "    primary_email character varying,\n" +
                "    password character varying,\n" +
                "    private_key character varying\n" +
                ");");
        postgresService.execute("INSERT INTO mock_participant(parent_participant_code,child_participant_code,primary_email,password,private_key)"+"VALUES ('hosp_hcx_955522@swasth-hcx-dev ','payr_hcxmoc_903588@swasth-hcx-dev','lagertha+mock_payor@yopmail.com','Opensaber@123','-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDAQLG7dTHuSE1F 8L46wS84SCU4Pf+ofSB8/h8tlyUHCw2SmY3CRZ3Uz1Jtw87UCdEvaSqs4YvkdKIh 1Nt04xpunUufUYNx6wBx/S/nuG7zcUu+bQeO1SpeEAA6+4HvnAyVBc+YCctnyREr Pgigs8MJG6dMA2rEap1na8VTrVN6JNNhcJxqnCyMoZ/aJIrmRxMj0Eh55LC20AZh jkxt5q/12qarpc/0ItQ2nv11fucojVVQyQGBaeqULVM9fGXbtquLXnRLJWzTLuSN Zk3Z+NpZZ5W7gxyBsxGTc7ccWp5edOxMXK3wELxsqirT0EOIz2ZMEYVbWrCyxfGC WYGUGRkPAgMBAAECggEACRAjsMweDfcfmW/3b8qioLsZ8hROJJG9gdby/lG1P6dA PQx7F9DzV1BsuNr1uZ4628rP5bV+REdRS1n+/HwmR1en9HtBwJGNBFKkuv5BUL2j DfeS1yNqa2PCtwUbQ4HuP+o1tpujmKFsa0bx3i2LQLcqhFVW56qFABafB0pQ+J2F 5MIgoS3e84Q/4oHYhxcRCgINQRoWKkqLGdAMg83NGe/G97PHGW9PPG9AQnfVhqey adov6rO/VOhbEYoKIwBq4G2qFnq6GwxDsx+wKl7SMVIwJzk8lRd5IaCGNscGEirU f/1PKxRT5WR735wyFyqLtSATFlrvH+sIiKsYR0PRlQKBgQDewV/umGidbm4jcmYR PFW53Ipr05lz4VNUOxdI/NIQ5jNfwjTE7Ep4R2xWycgzFwtoYYzWOhgHfSEcQ7KH 4z7w5Oe5CO+NB9viTxsrRx/kc6KU5cr3iqYCQzu2IaaVL2n6a0dDWR1ZXSGckKCf RWENuPkU9BAMn5LqEbcxVkSp6wKBgQDc8e4tMef6jpX5i8UEtd3y0HE302I1opfM 7Sdl5KVYsTOcTVobYM3niRKGtaY26EP7JCI2D0rCGS/DpDmsf7v5uHD4pZ4whRGR uhj64NIzveG3goki/ZerFZTc83mBxcaSBg48XL2x4oy32d0YXRC5IqEZ5vAIo7JE PlOZgKZAbQKBgQCVlVN/XHc76NErGoIx5stGYTPOzqxIZbJYaMntKGFEGeG71yUq a+ZiOMwmx5+Zt0rg0EkL/rzuInfejBNSLyawC3cUCU0b7oAYy7hZ6owfFAvEYz9V 1ZQ/BrkNSDGeEtXe5LVZI3mS7fhJM9G4wpU26tTQ3kf8whec+UKEbgLz+wKBgH1H EG2/5nFDd/ZPMh9Bn9+WIRwuV3liAADKV5SG2No5X7I4iecMNLQcHM0VInHvsNwt 2NgeQ51a+qJL9AfDRaqK0kOqZM/OI/AlPRTDdWyxNdL/yRJ2CBGR4x6FT1gt9DHI DTpcu5KpinCUr7Co1FqlMAOn1mKPrvzS+kQHljzhAoGBAL2Ui1c/qrX9ezggR78D WTK8u4QkvSdOoSDVbOes1FYEExHWh8hvRfO4PLTzlK58MJJnWj9hgiMItWzI7Iic pOEsHqgNl19VjdtKEloRAe5HYuC0pTTNTXo7qhq/De1wPr/lM82jofNXzpSpDetU 43Q9DXQ5KNiBbsKedfkRhJdY\n-----END PRIVATE KEY-----')");
        postgresService.execute("DROP TABLE IF EXISTS payersystem_data");
        postgresService.execute("CREATE TABLE payersystem_data (\n" +
                "    request_id character varying not null PRIMARY KEY,\n" +
                "    sender_code character varying,\n" +
                "    recipient_code character varying,\n" +
                "    action character varying,\n" +
                "    raw_payload character varying,\n" +
                "    request_fhir character varying,\n" +
                "    response_fhir character varying,\n" +
                "    status character varying,\n" +
                "    additional_info jsonb,\n" +
                "    created_on bigint,\n" +
                "    updated_on bigint,\n" +
                "    on_action_status character varying,\n" +
                "    correlation_id character varying,\n" +
                "    mobile character varying,\n" +
                "    otp_verification character varying,\n" +
                "    workflow_id character varying,\n" +
                "    account_number character varying,\n" +
                "    ifsc_code character varying,\n" +
                "    bank_details character varying,\n" +
                "    app character varying,\n" +
                "    supporting_documents jsonb,\n" +
                "    bill_amount character varying,\n" +
                "    insurance_id character varying,\n" +
                "    patient_name character varying,\n" +
                "    service_type character varying\n" +
                ");\n");
        postgresService.execute("INSERT INTO payersystem_data" +
                "(request_id, sender_code, recipient_code, action, raw_payload, request_fhir, response_fhir, status, additional_info, created_on, updated_on, on_action_status, correlation_id, mobile, otp_verification, workflow_id, account_number, ifsc_code, bank_details, app, supporting_documents, bill_amount, insurance_id, patient_name, service_type)" +
                "VALUES" + "('3730d51b-7371-4d34-8641-a005dadd2286', 'bsp_bsprol_846730@swasth-hcx-dev', 'payr_hcxmoc_903588@swasth-hcx-dev', 'preauth', 'eyJ4LWhjeC1yZWNpcGllbnRfY29kZSI6InBheXJfaGN4bW9jXzkwMzU4OEBzd2FzdGgtaGN4LWRldiIsIngtaGN4LXRpbWVzdGFtcCI6IjIwMjQtMDEtMTlUMTA6MTQ6NDErMDAwMCIsIngtaGN4LXNlbmRlcl9jb2RlIjoiYnNwX2JzcHJvbF84NDY3MzBAc3dhc3RoLWhjeC1kZXYiLCJ4LWhjeC1jb3JyZWxhdGlvbl9pZCI6IjJhODQ3ZTgxLWQzYWQtNGU5ZC04ZmQ1LTExMmYyNDhjMDI0ZCIsImVuYyI6IkEyNTZHQ00iLCJ4LWhjeC13b3JrZmxvd19pZCI6ImIyNTk1MTk1LWU0ZmItNDVkOS04NDI1LTgzOWYwOWExYmNmMyIsImFsZyI6IlJTQS1PQUVQLTI1NiIsIngtaGN4LWFwaV9jYWxsX2lkIjoiOTUzN2ZjZWYtN2NlNS00NDRkLThiN2UtODdkZGU5OTdiOGYyIn0.eofxxmBFV6AdKwtXWgrJfU76S_NnAFDmxwCxFF9XXtT4amw_pSmBq8y0M_WWel4n70RKzsr-Hk08qa3T1NzkLWHKvX6ZFcIqgERbRxdfb6qu-jtA5DSul_WtUkqOf9rTjBdPMhCGrw1GNhyrv9VcRqJep8zyqwVyDDgZ6TtKl44xK4MH9hDhK6ZqNB8I2V7NSaiWbIC2Tz1NJ_YmaDMYvW-zmc2okA8R-2d6BrmvKeIPVKxLWsL6gZ-dpBTJIIdKN4qOr1sDHpbyT0XWKGSZWdU1gv20PIZ317SyF1MhsqcVQeFFWOAPDssbgs02g60sRkiwYrng9WSrrKT_5KnJJg.HOJmTcJivz-eTo-l.a3C6rQW2u3IRCcUc4v9nOss4PkdqLwnL-2--TBb2qdLBQ24ILR3sdu7UanroM6fbuPTz2O7M9HJowUB7PS_EvG5W20STOeLoAcdgoi9rWGNxfLwYa51gbkknf1LnafsQqK7AiIgTYYKJ94kD9o4XYufTMBP8Trkv0NG1whF7DRoXyqekZcJYBobiehj0EDC2J021R7lALwdLFf3fC6o-wt5A-iRpmp1pPJpH01vef1nQIembnrcrCadAk_jSd2-XgsEIYyolHxoER2aFd34kT9q1_NY6pa5P2o4fC0s2VEvhxVL1BqJmqFImr4irEigT6vEGd0mtAu0EgBPG1uJvv2Rn9RpJM2Ucok1aZl29YJc_d2PbJm-3g7cAKcDq_qUXKRHtpYMs7DDhwNlRkKLtQtqYg_GL1bvFFzFD1WW55XLTOqe3ab3swx1daLy7ufT6cMnf1xvzr2j9-myw1JE4WWEqyJoWBcTH5tmav3g0u5LLjl0R9sQz60GWvjauOGZ5kpeOdfJZ6sh2DRUiAN8PBvGW12e7-bgtOoNserSwX-G3Q2_G0alljCiO-4VMvJF5PhedFBtEZTyGwO7gYVCS8Hv5qPsextuhXseEVUiaaCFb_3hbI1j4c9bc92HYWzUsckO3Vy82WcI_a4gUMzfIaxlgUZ57I47Q8reAw03aiBa0Xxof5wPwmOHPwRSuIU7cSvv1bbnQKqTPiAS2FgQ4TK_qFtA5EwKTsg95HNJJza8ORCU0hnDuK5JPourUlnwczdJa-QtgMs5pTOTqKrAEDpkVkkqY8T7d96lHU8l7TpeIsDx3lhtgJMDgPVjG_ZCiGaN5YYfS8fHa3N2uOgy0YjRtMkMGrswX_95tY4ErbaPG9dDx0Aqa3Ar0jVGgH-0NplKl4wgE5TYgQ-mG3Vuvh8Ht8FaBuyCmUi0zEDJrsWsE7RpXQDFd4b_dKyLsJ-u5YqUIDRuRhKU22OxZQBnzfLGVvC0P76eXfGOh1KuhdCaDB0UR_6g8vlML9eglLrbSIvfSPpbqNG9astCWy-0A7Y5kxm9oFksYt7FLh9-qYbJ1tnTcR41miyGF2H1aCBV0_fjbj8hQSUbgbopJloMLD8EADD310n9gjzHs5Olgg7gCvsI9zjAbb5zTuo9IGPIGPMZxkIl_WZt5RvXgksDySRRi_0dIMAbGfN4dBr90ciL9gTFJ3LpavW7lyfX6O73rIVSWS3oh4KzPjUBGoNKikMbkcwKmbAeVOZM9daA37n_PCIT7KWo_Tl11g-aCzBPsJykix_9qocNLJzHW_CuO_3RKBiv3rp8vB0nHRSc04csTQN3nT9KRyV13JJlLQvI9q6NO9FvxwSay-fNIXnsRh4NlAZrl9KJV0LJrvchPXtCB68PPGKONNnsxax78eutk1p1AJOXM1BYirjyKq5j7sts31XPQAAUD77F5dPMcMkSx4f3x7xHZx1fQi1hrh5IrsPClTupu819p9VazGMcBimS1idya3xX50sdbCbuUBxQFC2iOrsO6LkpNF8s0zWhpySvkxAUguXucfqrw352insjcSJmZ9gU20QakhbDNT3rwxh90BrsQihY9O-P-PQEIDH3lFrWjop6w8_geHSTw99hBCzL7PD00vJairCUSMISLdx57JXtoH4nifnrNLmuqX1ebLRZWEWnF01jo-JtRJPXasTlyogBnG6ZRXIaWU5gHmudKlNqTebOzq_Yap8pYRoohku_RV0NQrcq4FgPasAwJuorltLeXwGeReb-Yijq6-aMlJcaOop86gSt5ilBbuCd_2HjVO0zfqssSLPf-FAXm641cSZc0D64NCRUkwVyvteq1EmTXxtMeMStNB7AwBwnOKk35bVpP3M7xgpkUBgCzGQ_TqDpEFbtpVk2AHHLz25eFLyZaA4I-2m-3ouyzVvJgYPqWshvJEF3ipGtenMV1immUIloVFeG2gSJCig3G6bDeI6VZpsiaFvz0J-DaQBadKz5o29gq5QeM8KVpQQIhfSwCDjEDAqSLs9Zo9FDjN-2Wk-_YAhNGPgSzbfwNZ0Np8eGSph1qrzfZG3tVZKaTeybaJ-twmiX5Cx2RvR5RWxAaTC6euU-UIwwE_FBrgDmzGiht8erNtu3Ogzl3Oy-Cx_T9lltb4AmCgflbCGZvymMurrG0Z16zxyf8oU3y0HXhI3Sj2q1Fa8wCs3WuOM8h9KtwHWGUiziONoKuZFcvJNLbsSxi8k7RldhajtgoP-R9FQWyiGZZpcT0BswZhDABKeMpkbzfabDHGIFmCMnuwenl-Qynf8I5R0MxFp1BSiJc8m_9ldYRWaQ5MOTlbuZU4EprMd4H2xZWVM0-ii3ac_rXSyPwP1p-57_94hb6Da8j33kKDKPhgMZDyxfskYTdGPzdZnhlmqodoDboSgdcKK8YYH8ONT2OwTbCazdLj8pV9odkIrEHOuknUUvra4sFdaxb-42prO9T3YlrycQGunEUD9_mqkKDaX_tpD90XzRtuLCja9YSNx4KHFUHlZpMM2JVs71nUcdYQ7eqH56mWecr7lN-hYmMHw0yXNYQXEa8VMAVzO-dTayFPjdU0o2f5Y8qdl2nholQpW1wvQ-KlFhQZD7qDEE5P0ecuvDifDZyEVL1Xoye2VBPm3j9KO3C6Q2N5PLtHIrEcHmMMbVfz1VQD4LUB01xbcO6C9FT20d0IhBHiKKSSO6p8xuzmi4qxst0VKw6ZePA2gw7OKMnwycUcISCoOCjJUx3iD4oboJUEB9pyacrzTGztBGRscu8LmMUBdLnhZjBCPQZw564A9anN9EUZw26BSe8T_8VRkcqbwx-fLZeANJdCbfyrhRxfOzzntdpm8TpgiUyNfjupEN57PRxGG-2pQ160F1m7HqMcu-CU31xm9Ic9k-ExLO3BawY4UnQ4D-_aX37upgy4JR1IBF9OCF6fnsnjwX4ghGTrlJkGn0H_wPPLH5dFqb1c5zk7zdkE5DrVR_49XUl6b4kAbHHVA7Vpccd5Tk9Q-xek4esqifvQfrh3SJWmsA8_8Dv6cIc62R7y6YhjrelQjJUIZDG-tfFux4Fwf6uQVVbboCV7PQwiEkpeh7IsK0xiu9V6kV4UE8OgaUGdPRRyenM9DbesznLr6QXARam77hIHGR1BZXN5-ZEmnQOQGNPDiQoLDelzpYt0UzgdZpXQnCzJor8CJvFzjE28RMS9XwI1sKq3xBZ6kUMhTzquXrJsWudldj-iQch8Qz2RQTPLvbvxcOLsg6Cfz2lyY9bYxuNNEv_gKrFIPiXBS-IqI3o3_3GVOT14NW43-rrKEdxvKnkeytecgP5cmKIRFxMoyzohj0G18QoOIXWlwZD2roHFZEwhsNDvs16GwELU-hkIppyWwaIgZFck18o2Eg4zwPk9w1jmL5zrGdmQ9ZBTwMp2Ch0eDfmCL3CEz53r2VXMtv--CxW_XOfBUoxxKmOByJTo6GiJFidLcC_UXcX-CcHyTEHh5H9qICoBbt2byRtOhwEWJWHeWEJF9kK7XYoYo5zeFNToQ8haR716ffKIaeGVJUMz_zE8VA2T2XKu-z5cO1AJ6ZB46IjC2DjZr0aOObXGUS1PmzpXSEyBd2ph6GqLiWjt9THiCH7ParnYsAjyk6gmTyFgtysMaQxWtal6BUnu859K_1D4AMjjCsLTkzWWvJcJ7HN2ub9-8Cy3MtmOzS_fAhG7HeZXX-NjoSJZDpENMnMZKHOhNVTKQmd0DRMbJ1-T6FuIwH7yETrDvHj22SGn4AEB-z4mMpPnMZu-HowNHrQMnVDl1XWkYQGvagv1rGdIo-Nv9t4In-1heB9HnIUl4RJ8SgayiZ7tUSrxsCGuue9ZxuFRH1miirhRoE52kESI9Dq4r-GNQQ2x15w3B66n_9S-yBT6uqZ1NVCTml9bAxxZdOLqLGUBXbB8_doH5qZKU54oURMbV2DKo24MPH3xxzgf7zmqwJEWSyjFrtp1iNJEFq3WQsbp4-q2KWww3_BzJQAmj59iWjI7iXK8JcVsFk3enmzAgakLUsahFSlSn97WHlTQYCCyiluQiM5kjmBEOng-YB0KUNU10fkVIh4c7Grmups7Xl--6zCjPk0QnVRGUVTH6B6kfvEMLKTHfGlXA2jIPzkFlU7fg8TJgW9H5BCXiuccgsMrAwcB4ivm-o0UKW-XGGkM7ztKCkjzcOgCPO7a-VcVo5tUoZ3682p-MvkZFwk5luFt7E92cp_UpICCRXII1cr58KfSctpRmisJ_LlPAKFqQzmuGIRnDFNeoMGKNr2tBIeGtDHWHT8QZ6gnaME49x9BW63XGcvilfE5VdLKhUoTj0hftvlnD43YTSgqgKhVNjbXoqDaLatKYiubXsKdAtp_FLL1s-UkxuGK8TX0H8sxC_DSeHV_q6qTDmgZYuoWVyQk5UEJBABvCAO7qBSe7hHqq2F2x1hinPkdGW-srFSHDfUWKurCml2gST5zBMIrHhlMj3qg2t6Vvu0r55rMIqEgtULTraBwermGgdGOcDUARAH723wY4uuVMQ4JhkCFJgYFd1uasX54pejrfBMwiCrLRpxTo0wsxtZQU3P4qcGvPZmllD6bHmmCy95_AkSHDGzQ-gktc3tvEUhr7xBvcKn2VEjHQXWNnrwyPZTtfGOVsFznWGvtUzHMgenu6zkP3hG3maraZxjuB1KWZnmuTAfHn8Apr0SROsE9I8mik0aMzdU4GMDmiXGlKeUZzMCJcdBl5TPjVg54gmSSAUSoRU5Fqe_csO4Opv4vIIFwfPUvOSU-00JhNJwCqQ_JatPg7C39fYe8lPVo-xTCSOt_JIdkuc8vyLuVxgqlITpDbja_G7-CRFUivIT5Ny2AWxLi1cQ9xXqG7OozyTlsTcDLCsm0c-a_wNKv8s5ct6TrHfAGrPco2i8XLYsabEjBprXB03q7hmTHMl5j9jcZFbBcj4xlbt8zDiAVDSDHfa7SinFB0w3NgtMBTmlPr5Nx7It3-Jdr7oGaOTSN5joEnobfsGE9-N8s-237pFnqcIFTRvVSMIWtpgxd8_K86dbmd04YHuvR58gScvvFNjpap1MpXamhZMzRNgtT6B4OBLHlupG42ALKkSerz6nMZv-RW68l1OWr8iWl-WVBAyjxILQ7HEVkGqGX7v1zseQfFfmUP8HQkqyvB9hMsNcnCyoOVQ58AK-HUAkcNhuSwuzXBBB1stM3mngedBqElJNE43xuDq4GfqrSvKjqZCtd_8fR6ke-vnittwEU6y7DbE2CRoXrV3BuAciSVy0SxFsmx2v7lj3vmK1shg1_eWtlsGyIgZqkVYxJDZzMXN-RbEPZ0FUVRwN5h7_ub4vgj3q-YhmrPI-ZaWmacv12gNGPluLUf7tui-ZFRM7D3uf5KkeyV8pG5KTWt9QxCmGpY8WAckBRvOpg8kLIEnvPTZIM28ymnmYklnUMyhxBrmioP8xI3I5AqcmHPb2tLcsFf7uyh5SoD1KXKlokV2MCYgmbjq2TwnM-AXvy_1B2wh82-mcg-U8Mwx1T-L4osUOdXRRT1gP4FPSKLEbN3YUU_-d_OJNETIU-fnL7e_JOlxyGlzjzic81NTgOEd0XsUeWn1IDCBqh2bfmtjEQ7eEOGJkPHrIvIyCASjiO354wGsXlEca9NoyZpNeZ-mndxvrwQ-BIoY6xLmOYumEUL4UgvsWL0fZCJY-B8pNv7J0mniXJZSE5naRlrwS2Xa3ZYquOGwGjMk8YGqB8d2yhfAlz3AIuKHNo8KYM7tI7oY5G5jVa9zqMV5qrERnF--Q77bDBo4Ed2HSIBkrwICVJieuzMJTPYKtk3M7NJRe08ufyE5zRhvy3BOQek_XJkAvHOPGL0mUUaBhQdNIxudFbd1o_1LmE6_qrsnbStyrF24OUoPrZHcwyBDF16g_Yw6e1tJVgekHeJn9KAdRDG9Hk7RlG7Jv_WxYTDIsmbkXhLJolOjc2USFtzst8SNUlRJiaV0dlom2Ryq0qbUoCYFd3iOLunKvFKu-TkcV8hHT9O3Xl8n-aZdPlYR0VuLy5htqaJe57wC5gKAO15koDD0CR4Xkeomk0UyiOT7-qTihQ3W-zW0wf6M8GuX4zu4NGtR_wOTkDoaoS9Y2WB8AYlzWgMfUwamaJ9uClmkohEBZHQXRNc5Nr9Fuu9WciNMztQRhVqG8MBfuyzepBpuooatppTIcP7AC88UmGohUVIpfCPB5gkmvvYCNJeJM_D-0m7kzfH_x4TTcif1vfTdjhfExhS6qWK1EeBnygzoO_xdDGussUyQLgPm_qT0TgeacRPxLyMG9DCScm2P5kKkFtetLbSx3_q_WWJnF-YiZvtMlXVcqY7eP8-x8Ey0qTu82qONJJjBBoR3yzp3eW_qzYdGBQqtoIJWghAXxeTVs1ahEgZdYY00RsXZGCOtyFYOOhtwy0X1zvDwOmApzvkCOeEflfpOw58Br-orpL1SaA2e6-gS_daTgdYzYSE63BDaosugkOZOHjrmUiP8R6rGexmcOoP6G56EdjWkDj5iEP-K0RO5zIHoS4uYvcP3Z4VSq_IQDrG2LbFMGkJq96Wuk3LJEM9tYQQQ46m536x2vWmdXzS94PruZv88ZA-KEyDq9vjH0lZh0CodnGTeZlp3iWSEfmpkYyrZRJ87m8GGbNjqVBFhwRv4Pw8wxaHDRKS6Tf8VYWlez8YpHMlbUvAOAb1fjQEpQipN1cVOsk8J2JFAKcAfvcG8r3Y2mld2hokKLPhpf-YG3AcwxHeUB3SRKMUxSptwCKmVQxNfphtrSGarKOO0dYP4ZfW8ENzIlqlFZZ0D6bo7g3LX5zXg9123WuKZh2fR8DS6eClt1wO1hJdMOXF38KwZZ4bXAu5rfQ1AroKkVkx13VOhesAc340E-j3W0JXQA4jNZltqjvIz2Wx0xKXoJTWlAOAYc-uCugD27q3Nsh7vxaJyDcWukQbgzDd-nMv5afwtk06Eks9gHtsh3fZ-A7tMaccBlJ2aMUEH_Q4prXsVuKEY8R9l09RnKyc1Iu37jsyY_jpWiqfP1VnaNKnDDPOg8z5sW9T-W6UN740cQffrl-RMcLi5Ezts7nA612NEj1mXY6mRi8gzpYcP8R66zrk6KKvKknxsxSnulpsIOQMxDhtLKBTOtkAewEMKZHyAQRk8dPahTRfGBxRDNnugm8L5FIzVdbfN_jiZfjwJ5wq-_RRUqXT6plosNViozST3RzCmKEzfTek-LseGijhcC2Yn_p67xufUyHlp-C1Hqrs9q07_D2Ctggsc6D4FhzxdVrH_OMngHaUyMj_QFsUYb30O6aID5bRRQ4ccfpw-x5RduL6NvZcCt7A5bEdpvCim4SBkPhkdAcP4pmRewzDgPAFxk5vMO4vIjqic-jYwaLXNrxZedavoFZbstAvvUoKQmqGdl6Uqh3jmHuerPx7vPq4iYnC_h1kGJvWqTIiNS_31bN8Ly-fbMarxvFpJ5kxYQ2uuUQg4prlbc89ekjqk_UM3Or4d-cv-VPD6HOxlR-tG29m0D1RXadFVdvMPaeDxcEESGrByiHp_vD6WZnj2q8kbpeYtzeFmzRWCzZvDtZ1WktkCxhnoTqBwKQl5CgteH1EoWwgPAsAIDGpZvjjmvf4FZjsOBzVFiVOlNXUXjcaas0baYG84272N_ZMenfuwqlMBTiUxKE_jUM-a3yyyI1xIorrcLcaPwH0VS4YWN-x6xbqey6f150UkUv0UeNrpsCaMORj5G_kMK9eY-Ib9caKPuXfMmOx5geohVOgAHDGbO5xmOWo4YJP8CxN0omZmfHBoMHI3hlhpbHFc0u-FOpSQ7PwkIIvsE7fry9ddk5K1iN-yns-HzGSL6vZmxxJ7fQBI_Ofe6Hbm5VzzQdcUJBrmRqg4Nka3q256RxdM1mmJd8Sh8BiUqQxhYbgPkaSK2VSVSZIPfb9c1uRsYijfkRjYiQuVO6S0TaxEFI-Jvptg_SgTRHHUE8wnOi0VM9V5LoiQREA31K4_TtAT9rDoYSPYt6WXS8_xtU5OAehSFbg-4_MT5HrGZBmgY2gAigWc_5zcRw6nkRs6ZXFIHM8qIGHXYug707T-oYZQd7cS81PRI4phlR9M50j0TpfNCTenGxC7utFJ1AE_yohmFR5WskYyECKeQEDGinw29VfmBdtYLycsiTWWvpBlyhDpEeXuoqefG05WovGMHxcxYDtw6ywhHhxG7DoRiMTy_z6xCQOHPoEU-mc3X3XFKq2pIqND5ZCGxKiMaftUUGWrDAXh2tp9jNHZLN81pfuiuVOvAx9yqs6U0ZBY_CG-osL-eE08kkUYhucAzRT9Nl-GMFaLv4R2kofQp4pWl6V6jQ1ip1uqsLqT-YCiQ3zMtiFsu955APEoEgJ0r3wXVtWG7fWdhCQ5c135fwshAL-8weR4Wlm-3ftfuAKaqaS22EriGSxEP8tNnXq7cdGtBYbAq42m2eS6c3fmz6dzv2lPRFtnONr-TCfKYoIz6693McJ69VZ2rpmBqR8Bedu8tlq-TKjz80mOLj65GwIb9AKPkc2If0oJvFiBxcv6OApIkmgiHC-wWrq8HX-repI5XtuRs49aBMSFHTFcnlJ_cdbYdaO5FECwIgU6nlb8BRxJ-hdyvr38KKVG_VzRQHKriexsmWMxl5XmtNztxemjFK4P-9Ryj0lKLvk_VTP1syrBnEJto8yajbwDdGXxet91sCMhbwIKrU-8ddTYOSa40Wckh5nDTaRNCcG5uzTZGFnvGP5gSPxb04rZT7um89AZU0ROIS650YR2lqM04-aGxwRMjbl3Gs-qAfSy4XQrn_BGcXqMs2Gjb_Eq2D7tACmgIdFDyFkG_VqF8d9xoLJjMhaUMKmTkeYGr7oO8HYhmgjTv3f5YG6KGKUYmJwDRutiOqcrNukmGqAYuAv9XEIWAF4dAMGe5oXcqzwIb-BpchUT4YHyudOs8GO9nE77DljH7fJ5SCas_PgfCB1bWVEz7UGvtptIlypAt35PYP_mFcqFMas6i4twbu9Vfa3X7655NxwmEGQ-Vs_6MBNZCFQjwDFxAr1RpqbxSzpCX9rSzf0ITNmjhPGL5Zp5MRecFPwfJdeve6h5cUErLSmA6uhjBF1QL1K23LoETw6Ev9uyTkfenNtvVdTWgwECvMu4NbuEmGUZjDRodTNWKjNV2OAIjJxmbLNHKnobc8h6s7B69c6NsROWYYw-49M24MAhq1_ZeaTWjEiIw7iaY-YW0e9jTv8sGXzpNmw_llqB9x7bV7DR88EwMO5ADsghGSLHoTNydb6wBd3-B6Nqkj79orAI8o6xAlHndqlE2744WNci8StM3qndsinqXxUsUa-c0eO9WFGmTYTxYfWaqdjBWvqIuqij7oR_zPIUMf3ZBs02ZNGLS3O9r05KXwwRsS3oD4S0eSMXcmY3jza7S4xcX7TkpelwwSa53G2RfqRbFPuwGXOj0Ya4lBnYykFIYuRRmlbdwX-N3IecHBNlpCHFgCcMBjWAJ3MldkPEVHc52SLsV3cN6qZdRJbmMlck8Km6sfS-1RbzDa9Wob09RmSlIPVNFhmydmCJC85X84HQw320dy-l-Y3S0LgeXeMtcn03atCwrQ-IldBqkIBQ5i2isIdcK-rveJPVcRo_PqXxaB0UmjrVmWHuVFwBg56v_2MncPzzQH4Av6tZZ7gptGNERi5dpPqwefM5yKC8GRPwiSM0ERpFT9Em3C6GPe2GKMjDlvRqA19WEub5Wl5GJcfn9M9Wo2-FINuIWx3rsCLNxCLXuJrEqbaQp54_v_iGit1GbTIgUZ3rZ8eIBzOWdmWIgBvoOJOFwi0vPqPs-38swJw3JVscvG8Ug3E9bnh7icBkrNVMANdPYALYGfl0V7z8HyMpREmFx5ALLqiGQwTzAXEcYorXHk_bIPh4rJmfuJKAcruGZui8po9XKal3tGvYNFOxht3ScE9WiEqwnT_Bx2OqUdgR0jAat4692J2j1i58IULmSeUT3NJUuW97QU2jXvQcJpzWYbccV5xWW94WHQ8GmtRrrM3zf_5nSfS0sZknUPDpgPWiu5VghCBohNPsUqE4dbBk7ytY_MOoB90X3hpWsT6pF7tC1wktLPXM5FgEFWdJO3J9pFCcf94mr8pHxh6a6dF34jPbZ2LEbbFQxRzutDftf0sNJUYH9fWy9m5W_YakRSdJfs_-Euz1cxR1CRUuUf_MbqzNzgmrCGjoCC6zoJg048ennOiicumpDzXZ11lDj_c20OO5TseYpwFc_2q--uFUGfUKSQfvZJX2Z0KAK3o1Z5cHQmsbCP33dp-aq0wYQAvQLL7kdSO3Q4r36cSsIIpVfwaOjcA.JGOqlY8NLr7zUGp-3z7k7Q','{}','{ \"resourceType\": \"Bundle\", \"id\": \"3730d51b-7371-4d34-8641-a005dadd2286\", \"meta\": { \"lastUpdated\": \"2024-01-19T10:17:02.570+00:00\", \"profile\": [\"https://ig.hcxprotocol.io/v0.7.1/StructureDefinition-ClaimResponseBundle.html\"] }, \"identifier\": { \"system\": \"https://www.tmh.in/bundle\", \"value\": \"93d2f78b-897b-4581-aee3-5ea9ccf62e45\" }, \"type\": \"collection\", \"timestamp\": \"2024-01-19T10:17:00.421+00:00\", \"entry\": [ { \"fullUrl\": \"ClaimResponse/fe4216f5-6c38-4b8a-9664-8e090d9576e2\", \"resource\": { \"resourceType\": \"ClaimResponse\", \"id\": \"fe4216f5-6c38-4b8a-9664-8e090d9576e2\", \"meta\": { \"lastUpdated\": \"2024-01-19T10:17:02.570+00:00\", \"profile\": [\"https://ig.hcxprotocol.io/v0.7.1/StructureDefinition-ClaimResponse.html\"] }, \"identifier\": [ { \"system\": \"http://identifiersystem.com\", \"value\": \"b6bbfee4-075e-4c48-bbd8-7e09fa1bb54a\" } ], \"status\": \"active\", \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/claim-type\", \"code\": \"institutional\" } ] }, \"use\": \"claim\", \"patient\": { \"reference\": \"Patient/RVH1003\" }, \"created\": \"2024-01-19T10:17:02+00:00\", \"insurer\": { \"reference\": \"Organization/GICOFINDIA\" }, \"requestor\": { \"reference\": \"Organization/WeMeanWell01\" }, \"request\": { \"reference\": \"Claim/CLAIM1\" }, \"outcome\": \"complete\", \"total\": [ { \"category\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/adjudication\", \"code\": \"benefit\" } ] }, \"amount\": { \"value\": 80000, \"currency\": \"INR\" } } ] } }, { \"fullUrl\": \"Organization/WeMeanWell01\", \"resource\": { \"resourceType\": \"Organization\", \"id\": \"WeMeanWell01\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Organization\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"AC\", \"display\": \"Narayana\" } ] }, \"system\": \"http://abdm.gov.in/facilities\", \"value\": \"HFR-ID-FOR-TMH\" } ], \"name\": \"BSP Role Mock User\", \"address\": [ { \"text\": \" Bannerghatta Road, Bengaluru \", \"city\": \"Bengaluru\", \"country\": \"India\" } ] } }, { \"fullUrl\": \"Organization/GICOFINDIA\", \"resource\": { \"resourceType\": \"Organization\", \"id\": \"GICOFINDIA\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Organization\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"AC\", \"display\": \"GOVOFINDIA\" } ] }, \"system\": \"http://irdai.gov.in/insurers\", \"value\": \"GICOFINDIA\" } ], \"name\": \"Demo Payor\" } }, { \"fullUrl\": \"Patient/RVH1003\", \"resource\": { \"resourceType\": \"Patient\", \"id\": \"RVH1003\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Patient\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"SN\", \"display\": \"Subscriber Number\" } ] }, \"system\": \"http://gicofIndia.com/beneficiaries\", \"value\": \"BEN-101\" } ], \"name\": [ { \"text\": \"Abhishek\" } ], \"telecom\": [ { \"system\": \"phone\", \"value\": \"9620499129\" } ], \"gender\": \"male\", \"birthDate\": \"1960-09-26\", \"address\": [ { \"text\": \"#39 Kalena Agrahara, Kamanahalli, Bengaluru - 560056\", \"city\": \"Bengaluru\", \"state\": \"Karnataka\", \"postalCode\": \"560056\", \"country\": \"India\" } ] } }, { \"fullUrl\": \"Coverage/COVERAGE1\", \"resource\": { \"resourceType\": \"Coverage\", \"id\": \"COVERAGE1\", \"meta\": { \"profile\": [\"https://ig.hcxprotocol.io/v0.7.1/StructureDefinition-Coverage.html\"] }, \"identifier\": [ { \"system\": \"https://www.gicofIndia.in/policies\", \"value\": \"policy-RVH1003\" } ], \"status\": \"active\", \"subscriber\": { \"reference\": \"Patient/RVH1003\" }, \"subscriberId\": \"ABCD1234\", \"beneficiary\": { \"reference\": \"Patient/RVH1003\" }, \"relationship\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/subscriber-relationship\", \"code\": \"self\" } ] }, \"payor\": [ { \"reference\": \"Organization/GICOFINDIA\" } ] } }, { \"fullUrl\": \"Practitioner/PractitionerViswasKar\", \"resource\": { \"resourceType\": \"Practitioner\", \"id\": \"PractitionerViswasKar\", \"meta\": { \"profile\": [\"https://nrces.in/ndhm/fhir/r4/StructureDefinition/Practitioner\"] }, \"identifier\": [ { \"type\": { \"coding\": [ { \"system\": \"http://terminology.hl7.org/CodeSystem/v2-0203\", \"code\": \"MD\", \"display\": \"Medical License number\" } ] }, \"system\": \"http://abdm.gov.in/facilities\", \"value\": \"DOC-123/456\" } ], \"name\": [ { \"text\": \"Dr Viswas kar\" } ] } } ] }', 'Approved', '{\"medical\": {\"status\": \"Approved\", \"remarks\": \"\"}, \"financial\": {\"status\": \"Approved\"}}', '1705661714568', '1705661715600', 'response.complete', 'c3e73251-dffb-446e-a028-e0748bd1abdd', '9620499129', 'Approved', 'e-ce224fd0b737', '1234', '1234', 'Approved', 'ABSP', '{}', '987664543', 'ABCD1234', 'Abhishek', 'medical')");
        String requestBody = getPreAuthRequestBody();
        MvcResult mvcResult = mockMvc.perform(post("/"+api_version+"/preauth/submit").content(requestBody).contentType(MediaType.APPLICATION_JSON)).andReturn();
        MockHttpServletResponse response = mvcResult.getResponse();
        int status = response.getStatus();
        assertEquals(202, status);
    }

    @Test
    public void check_preauth_submit_decryption_error_scenario() throws Exception {
        postgresService.execute("DROP TABLE IF EXISTS mock_participant");
        postgresService.execute("CREATE TABLE mock_participant (\n" +
                "    parent_participant_code character varying,\n" +
                "    child_participant_code character varying PRIMARY KEY,\n" +
                "    primary_email character varying,\n" +
                "    password character varying,\n" +
                "    private_key character varying\n" +
                ");");
        postgresService.execute("INSERT INTO mock_participant(parent_participant_code,child_participant_code,primary_email,password,private_key)"+"VALUES ('hosp_hcx_955522@swasth-hcx-dev','bsp_bsprol_846730@swasth-hcx-dev','lagertha+mock_payor@yopmail.com','Opensaber@123','-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDAQLG7dTHuSE1F 8L46wS84SCU4Pf+ofSB8/h8tlyUHCw2SmY3CRZ3Uz1Jtw87UCdEvaSqs4YvkdKIh 1Nt04xpunUufUYNx6wBx/S/nuG7zcUu+bQeO1SpeEAA6+4HvnAyVBc+YCctnyREr Pgigs8MJG6dMA2rEap1na8VTrVN6JNNhcJxqnCyMoZ/aJIrmRxMj0Eh55LC20AZh jkxt5q/12qarpc/0ItQ2nv11fucojVVQyQGBaeqULVM9fGXbtquLXnRLJWzTLuSN Zk3Z+NpZZ5W7gxyBsxGTc7ccWp5edOxMXK3wELxsqirT0EOIz2ZMEYVbWrCyxfGC WYGUGRkPAgMBAAECggEACRAjsMweDfcfmW/3b8qioLsZ8hROJJG9gdby/lG1P6dA PQx7F9DzV1BsuNr1uZ4628rP5bV+REdRS1n+/HwmR1en9HtBwJGNBFKkuv5BUL2j DfeS1yNqa2PCtwUbQ4HuP+o1tpujmKFsa0bx3i2LQLcqhFVW56qFABafB0pQ+J2F 5MIgoS3e84Q/4oHYhxcRCgINQRoWKkqLGdAMg83NGe/G97PHGW9PPG9AQnfVhqey adov6rO/VOhbEYoKIwBq4G2qFnq6GwxDsx+wKl7SMVIwJzk8lRd5IaCGNscGEirU f/1PKxRT5WR735wyFyqLtSATFlrvH+sIiKsYR0PRlQKBgQDewV/umGidbm4jcmYR PFW53Ipr05lz4VNUOxdI/NIQ5jNfwjTE7Ep4R2xWycgzFwtoYYzWOhgHfSEcQ7KH 4z7w5Oe5CO+NB9viTxsrRx/kc6KU5cr3iqYCQzu2IaaVL2n6a0dDWR1ZXSGckKCf RWENuPkU9BAMn5LqEbcxVkSp6wKBgQDc8e4tMef6jpX5i8UEtd3y0HE302I1opfM 7Sdl5KVYsTOcTVobYM3niRKGtaY26EP7JCI2D0rCGS/DpDmsf7v5uHD4pZ4whRGR uhj64NIzveG3goki/ZerFZTc83mBxcaSBg48XL2x4oy32d0YXRC5IqEZ5vAIo7JE PlOZgKZAbQKBgQCVlVN/XHc76NErGoIx5stGYTPOzqxIZbJYaMntKGFEGeG71yUq a+ZiOMwmx5+Zt0rg0EkL/rzuInfejBNSLyawC3cUCU0b7oAYy7hZ6owfFAvEYz9V 1ZQ/BrkNSDGeEtXe5LVZI3mS7fhJM9G4wpU26tTQ3kf8whec+UKEbgLz+wKBgH1H EG2/5nFDd/ZPMh9Bn9+WIRwuV3liAADKV5SG2No5X7I4iecMNLQcHM0VInHvsNwt 2NgeQ51a+qJL9AfDRaqK0kOqZM/OI/AlPRTDdWyxNdL/yRJ2CBGR4x6FT1gt9DHI DTpcu5KpinCUr7Co1FqlMAOn1mKPrvzS+kQHljzhAoGBAL2Ui1c/qrX9ezggR78D WTK8u4QkvSdOoSDVbOes1FYEExHWh8hvRfO4PLTzlK58MJJnWj9hgiMItWzI7Iic pOEsHqgNl19VjdtKEloRAe5HYuC0pTTNTXo7qhq/De1wPr/lM82jofNXzpSpDetU 43Q9DXQ5KNiBbsKedfkRhJdY\n-----END PRIVATE KEY-----')");
        String requestBody = getPreAuthRequestBody();
        MvcResult mvcResult = mockMvc.perform(post("/"+api_version+"/preauth/submit").content(requestBody).contentType(MediaType.APPLICATION_JSON)).andReturn();
        MockHttpServletResponse response = mvcResult.getResponse();
        int status = response.getStatus();
        assertEquals(400, status);
    }


    @Test
    public void check_preauth_on_submit_success_scenario() throws Exception {
        postgresService.execute("DROP TABLE IF EXISTS mock_participant");
        postgresService.execute("CREATE TABLE mock_participant (\n" +
                "    parent_participant_code character varying,\n" +
                "    child_participant_code character varying PRIMARY KEY,\n" +
                "    primary_email character varying,\n" +
                "    password character varying,\n" +
                "    private_key character varying\n" +
                ");");
        postgresService.execute("INSERT INTO mock_participant(parent_participant_code,child_participant_code,primary_email,password,private_key)"+"VALUES ('hosp_hcx_955522@swasth-hcx-dev ','bsp_bsprol_846730@swasth-hcx-dev','lagertha+mock_payor@yopmail.com','Opensaber@123','-----BEGIN PRIVATE KEY-----\nMIIEvgIBADANBgkqhkiG9w0BAQEFAASCBKgwggSkAgEAAoIBAQDAQLG7dTHuSE1F8L46wS84SCU4Pf+ofSB8/h8tlyUHCw2SmY3CRZ3Uz1Jtw87UCdEvaSqs4YvkdKIh1Nt04xpunUufUYNx6wBx/S/nuG7zcUu+bQeO1SpeEAA6+4HvnAyVBc+YCctnyRErPgigs8MJG6dMA2rEap1na8VTrVN6JNNhcJxqnCyMoZ/aJIrmRxMj0Eh55LC20AZhjkxt5q/12qarpc/0ItQ2nv11fucojVVQyQGBaeqULVM9fGXbtquLXnRLJWzTLuSNZk3Z+NpZZ5W7gxyBsxGTc7ccWp5edOxMXK3wELxsqirT0EOIz2ZMEYVbWrCyxfGCWYGUGRkPAgMBAAECggEACRAjsMweDfcfmW/3b8qioLsZ8hROJJG9gdby/lG1P6dAPQx7F9DzV1BsuNr1uZ4628rP5bV+REdRS1n+/HwmR1en9HtBwJGNBFKkuv5BUL2jDfeS1yNqa2PCtwUbQ4HuP+o1tpujmKFsa0bx3i2LQLcqhFVW56qFABafB0pQ+J2F5MIgoS3e84Q/4oHYhxcRCgINQRoWKkqLGdAMg83NGe/G97PHGW9PPG9AQnfVhqeyadov6rO/VOhbEYoKIwBq4G2qFnq6GwxDsx+wKl7SMVIwJzk8lRd5IaCGNscGEirUf/1PKxRT5WR735wyFyqLtSATFlrvH+sIiKsYR0PRlQKBgQDewV/umGidbm4jcmYRPFW53Ipr05lz4VNUOxdI/NIQ5jNfwjTE7Ep4R2xWycgzFwtoYYzWOhgHfSEcQ7KH4z7w5Oe5CO+NB9viTxsrRx/kc6KU5cr3iqYCQzu2IaaVL2n6a0dDWR1ZXSGckKCfRWENuPkU9BAMn5LqEbcxVkSp6wKBgQDc8e4tMef6jpX5i8UEtd3y0HE302I1opfM7Sdl5KVYsTOcTVobYM3niRKGtaY26EP7JCI2D0rCGS/DpDmsf7v5uHD4pZ4whRGRuhj64NIzveG3goki/ZerFZTc83mBxcaSBg48XL2x4oy32d0YXRC5IqEZ5vAIo7JEPlOZgKZAbQKBgQCVlVN/XHc76NErGoIx5stGYTPOzqxIZbJYaMntKGFEGeG71yUq a+ZiOMwmx5+Zt0rg0EkL/rzuInfejBNSLyawC3cUCU0b7oAYy7hZ6owfFAvEYz9V 1ZQ/BrkNSDGeEtXe5LVZI3mS7fhJM9G4wpU26tTQ3kf8whec+UKEbgLz+wKBgH1H EG2/5nFDd/ZPMh9Bn9+WIRwuV3liAADKV5SG2No5X7I4iecMNLQcHM0VInHvsNwt 2NgeQ51a+qJL9AfDRaqK0kOqZM/OI/AlPRTDdWyxNdL/yRJ2CBGR4x6FT1gt9DHI DTpcu5KpinCUr7Co1FqlMAOn1mKPrvzS+kQHljzhAoGBAL2Ui1c/qrX9ezggR78D WTK8u4QkvSdOoSDVbOes1FYEExHWh8hvRfO4PLTzlK58MJJnWj9hgiMItWzI7Iic pOEsHqgNl19VjdtKEloRAe5HYuC0pTTNTXo7qhq/De1wPr/lM82jofNXzpSpDetU43Q9DXQ5KNiBbsKedfkRhJdY\n-----END PRIVATE KEY-----')");
        String requestBody = getPreAuthOnSubmitRequestBody();
        MvcResult mvcResult = mockMvc.perform(post("/"+api_version+"/preauth/on_submit").content(requestBody).contentType(MediaType.APPLICATION_JSON)).andReturn();
        MockHttpServletResponse response = mvcResult.getResponse();
        int status = response.getStatus();
        assertEquals(202, status);
    }


}